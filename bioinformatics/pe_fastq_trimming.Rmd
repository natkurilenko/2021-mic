---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.11.3
  kernelspec:
    display_name: Bash
    language: bash
    name: bash
---

# Paired-End: Trimming and Filtering a FASTQ


```{bash}
source bioinf_config.sh
mkdir -p $PE_TRIM_DIR
```

Now let's check to be sure that worked.  We will run `ls` and check that these directories now exist in the `$CUROUT` directory.

```{bash}
ls $PE_OUT_DIR
```

# Trimming and Filtering
For Trimmomatic we use a different "program" for paired-end data: `TrimmomaticPE`. The parameters are a bit different. 


```{bash}
TrimmomaticPE
```

```{bash}
TrimmomaticPE \
    -threads $TOTAL_THREADS \
    -phred33 \
    ${RAW_FASTQ_DIR}/SRR12804466_1.fastq.gz \
    ${RAW_FASTQ_DIR}/SRR12804466_2.fastq.gz \
    ${PE_TRIM_DIR}/SRR12804466_1_trimmed.fastq.gz \
    ${PE_TRIM_DIR}/SRR12804466_1_unpaired.fastq.gz \
    ${PE_TRIM_DIR}/SRR12804466_2_trimmed.fastq.gz \
    ${PE_TRIM_DIR}/SRR12804466_2_unpaired.fastq.gz \
    ILLUMINACLIP:TruSeq2-PE.fa:2:30:10:2:keepBothReads LEADING:3 TRAILING:3 MINLEN:36
```

at this point we could run fastqc on the output of fastq-mcf to see if statistics have improved, but we will skip that for now.

```{bash}
ls $PE_TRIM_DIR
```
