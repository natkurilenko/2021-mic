# Working with Unix

## Author: Cliburn Chan
## Edited by: Janice McCarthy

## Bash kernel
In the previous unit, we used the terminal window to type commands to the bash shell. The Jupyter notebook interface allows us to create bash code cells, so that we can create a reproducible series of commands. We can also write 'shell scripts', which are text files that can be read by bash, but as we will do the entire RNA analysis pipeline using notebooks, those are beyond our scope.

In this unit, we'll re-inforce some of the last unit. The following commands are very useful:

## File and directory navigation

```
pwd   Print working direcoory
ls    List files
mkdir Make directory
rmdir Remove directory
cd    Change directory
rm    Remove file
touch Create empty file
cp    Copy file
mv    Move file
```

### Where am I?


```{bash}
pwd
```

### Why does it matter where I am? 

The concept of the 'working directory' comes from the way that bash locates files. The default place for bash to look is in the 'working directory'. We saw earlier that you can 'change directories' using `cd`. 


### List files

We can list the files in the 'current' or working directory using `ls`.


```{bash}
ls
```

Some files are 'hidden' (by default, `ls` does not list files whose names start with '.')

```{bash}
ls -a
```

```{bash}
ls -l
```

Fields returned by `ls -l`:

- Permissions
- Number of hardlinks
- File owner
- File group
- File size
- Modification time
- Filename

Interpreation of permissions
```
-rw-r--r--

-   Regular file
rw- Owner has Read and Write permission
r-- Group has Read permission
r-- Other has Read permission
```

### Globbing


```{bash}
ls *Rmd
```

```{bash}
ls U*
```

```{bash}
ls *nix??_*Exercises*
```

### Make directories


```{bash}
mkdir a
mkdir a/b
mkdir a/b/c
```


```{bash}
ls
```

```{bash}
ls -R
```

```{bash}
ls -l
```

```{bash}
rmdir a/b/c
rmdir a/b
rmdir a
```


```{bash}
ls
```

### Making nested directories in one step


```{bash}
mkdir -p a/b/c a/b/d a/b/e
```

### Create empty files


```{bash}
touch a/b/c/foo.txt a/b/d/bar.txt a/b/e/baz.txt
```


```{bash}
ls -R
```

```{bash}
cp a/b/c/foo.txt foo_copy1.txt
cp a/b/c/foo.txt a/foo_copy2.txt
cp a/b/c/foo.txt a/b/foo_copy3.txt
```


```{bash}
ls -R
```

```{bash}
mv a/b/c/foo.txt a/b/c/oof.txt
```


```{bash}
ls a/b/c
```

```{bash}
mv a/b/c/oof.txt oof.txt
```


```{bash}
ls a/b/c
```


```{bash}
ls 
```

### Navigating between directories


```{bash}
cd a/b/
```


```{bash}
ls
```

#### Deleting a file


```{bash}
rm foo_copy3.txt
```


```{bash}
ls
```

### Move back


```{bash}
pwd
```

```{bash}
cd ..
```


```{bash}
pwd
```

```{bash}
cd ..
```


```{bash}
pwd
```

```{bash}
cd a/b/c
```


```{bash}
pwd
```

```{bash}
cd ../../../
```


```{bash}
pwd
```

#### Go home


```{bash}
cd ~
```


```{bash}
pwd
```

#### Go last position


```{bash}
cd -
```

### Pathnames

We've already used pathnames, but didn't point them out. We have seen that bash looks in the current directory for files, and if we look for a file that is not in the current directory, but exists elsewhere, we'll get an error:

```{bash}
ls b
```

Bash doesn't see 'b' because it's not in the current directory. We can give its (relative) path name and bash can find it:

```{bash}
ls a/b
```

Because 'b' is a directory, `ls` displays its contents.


### Quick and dangerous recursive deletion


```{bash}
rm -r a
```


```{bash}
ls 
```

I can see from the `ls` command that the only files with the extension '.txt' are `foo_copy1.txt` and `oof.txt`.  I want to remove them, and to do that I can use `rm *.txt`. But I get a little paranoid when using `*` with `rm`, so I will often check first, giving the exact string first to `ls`.

```{bash}
ls *.txt
```

```{bash}
rm *.txt
```


```{bash}
ls
```

## Exercises

1. Create the following structure including empty files using `mkdir` and `touch` commands.

```
crytococcus
    data
        fake1.fq
        fake2.fq
    notebooks
        my_analysis.R
        your_analysis.R
        fake3.fq
    results
        table1.csv
        table2.csv
        fig1.png
        fig2.png
```


```{bash}

```

2. Navigate into the folder `cryptococcus/results` and find the size of `fig1.png`. Next make a copy of `table2.csv` with name `table3.csv`. Finally, navigate back to the same directory where this notebook is found.


```{bash}

```

3. Move the file `fake3.fq` from the `notebooks` to the `data` directory.


```{bash}

```

4. List all files recursively that have the extension `.R`


```{bash}

```

5. Delete the results directory and all files in it (non-recursively).


```{bash}

```

6. Delete the `cryptococcus` directory recursively.


```{bash}

```
